@*去掉头部*@
@{
    //Layout = "~/Views/Shared/_Layout.cshtml";
    Layout = null;
}


@*引入js样式*@
@*@Scripts.Render("");*@
@*引入css样式*@
@{
    ViewBag.Title = "Index";
}
<!DOCTYPE html>
<html>
<head>

    <title>Item Order Form</title>
    <!-- Meta tag Keywords -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8" />
    <meta name="keywords" content="Item Order Form Responsive Widget,Login form widgets, Sign up Web forms , Login signup Responsive web form,Flat Pricing table,Flat Drop downs,Registration Forms,News letter Forms,Elements" />
    <script>
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);

        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    </script>
    <!-- Meta tag Keywords -->
    <!-- css files -->
    <!-- Style-CSS -->
    <!-- Font-Awesome-Icons-CSS -->
    <!-- //css files -->
    <!-- web-fonts -->
    <script src="~/Content/Ui/ShoppingCart/jquery-1.11.min.js"></script>
    <link href="~/Content/Ui/ShoppingCart/bootstrap.min.css" rel="stylesheet" />
    <link  href="~/Content/Ui/MusicPlaying/MusicPlayingModule/css/index.css"/>

    <title>结账表单页面</title>
    <!--Bootstrap core CSS-->
    <link rel="stylesheet" href="~/Content/Ui/Order/css/style.css">
</head>
<body>

    <!-- title -->
    <h1 class="header-w3ls" style="color:black">Item Order Form</h1>
    <!-- //title -->
    <!-- content -->
    <div class="porduct-order-agile">
        <form action="#" method="post">
            <div id="Infor">
                <div class='form-group'>
                    <p>购买人:</p>
                    <input id="userName" type='text' name='name' value=" " readonly>
                </div>
            </div>
        </form>
        <div id="ItemInfor">
        </div>
        <button type="submit" class="btn btn-primary" onclick="AddOrder()">Submit</button>
    </div>
    <!--页脚开始-->
    <div data-v-c48b221a>
        <div class="footer" data-v-c48b221a>
            <div class="container" data-v-c48b221a>
                <div class="foot_tit" data-v-c48b221a>
                    <p data-v-c48b221a>下载阿里旺旺音乐客户端</p>
                    <p data-v-c48b221a>协议与声明</p>
                    <p data-v-c48b221a>其它</p>
                </div>
                <div class="foot_info" data-v-c48b221a>
                    <div class="item" data-v-c48b221a>
                        <ul class="download" data-v-c48b221a>
                            <li data-v-c48b221a>
                                <a href="3089109199.htm" data-v-c48b221a>
                                    <i class="iconfont icon-banner_icon_windows_" data-v-c48b221a></i>
                                    <span data-v-c48b221a>PC版</span>
                                </a>
                                <!---->
                            </li>
                            <li data-v-c48b221a>
                                <a href="javascript:;" data-v-c48b221a>
                                    <i class="iconfont icon-banner_icon_android_" data-v-c48b221a></i>
                                    <span data-v-c48b221a>Android</span>
                                </a>
                            </li>
                            <li data-v-c48b221a>
                                <a href="javascript:;" data-v-c48b221a>
                                    <i class="iconfont icon-footer_pic_iphone_" data-v-c48b221a></i>
                                    <span data-v-c48b221a>iPhone版</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="item" data-v-c48b221a>
                        <p data-v-c48b221a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>用户服务协议</a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>隐私政策</a>
                        </p>
                        <p data-v-c48b221a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>免责声明</a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>权利声明</a>
                        </p>
                    </div>
                    <div class="item" data-v-c48b221a>
                        <p data-v-c48b221a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>联系我们</a>
                            <a target="_blank" rel="nofollow" href="" data-v-c48b221a>广告服务</a>
                        </p>
                        <p data-v-c48b221a>
                            <span class="text_line" data-v-c48b221a>
                                <a target="_blank" rel="nofollow" href="" style="margin-right: 40px" data-v-c48b221a>阿里哇哇音乐</a>
                                <a target="_blank" rel="nofollow" href="" data-v-c48b221a>诚聘英才</a>
                            </span>
                            <span class="text_line" data-v-c48b221a>

                                <a target="_blank" rel="nofollow" href="" data-v-c48b221a>网上有害信息举报专区</a>
                            </span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="copy" data-v-c48b221a>
            <div class="text container" data-v-c48b221a>
                <p data-v-c48b221a>
                    柳州旺旺科技有限公司版权所有 丨 网络文化经营许可证：
                    <a target="_blank" href="" data-v-c48b221a>阿里旺旺[2021]0666-402号</a>丨
                    <a target="_blank" href="" style="display:none;" data-v-c48b221a>柳州职业技术学院许可证6666666666号</a>丨 电信学院真牛许可证NB-20210107 丨
                    <a target="_blank" href="../resource/doc/icp.pdf" data-v-c48b221a>柳NB证0310669号</a>
                </p>
                <p data-v-c48b221a>
                    <a target="_blank" href="" data-v-c48b221a>旺旺电视节目制作经营许可证柳字第9999号</a>丨
                    <a target="_blank" href="" data-v-c48b221a>阿里旺旺许可证柳州市演1574</a>丨
                    <a target="_blank" href="" data-v-c48b221a>旺旺安备9996969476431号</a>丨
                    <span data-v-c48b221a>
                        <a target="_blank" href="" data-v-c48b221a>柳州职业技术学院0832号</a>
                    </span>
                </p>
                <p data-v-c48b221a>举报电话：666-66666666丨 举报邮箱：jubao@123.ww</p>
            </div>
        </div>
        <div class="model" style="display:none;" data-v-72d4e460 data-v-c48b221a>
            <div class="tit" data-v-72d4e460>
                <span style="display:none;" data-v-72d4e460>阿里旺旺音乐Android最新版</span>
                <span style="display:none;" data-v-72d4e460>阿里旺旺音乐iphone最新版</span>
                <i class="iconfont icon-list_icon_x" data-v-72d4e460></i>
            </div>
            <div data-v-72d4e460>
                <div class="btns" data-v-72d4e460>
                    <div class="line" data-v-72d4e460></div>
                    <div data-v-72d4e460>
                        <img src="" alt class="codeimg" data-v-72d4e460>
                        <p class="tip" data-v-72d4e460>扫描二维码下载</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--页脚结束-->
    <input type="hidden" name="name" id="ViewBagData" value="@ViewBag.Data" />
</body>
</html>
<script>
    //提前定义
    var data = [];
    var $dataItem = '';
    var ShoppingItem = '';
    var element = $("#Infor");
    var ccc = $("#ItemInfor");
    var data = $("#ViewBagData").val();

    var list = [];
    $(function () {
        InitData();
    });

    function formatDatetime(date) {
        var y = date.getFullYear();
        var m = date.getMonth() + 1;
        m = m < 10 ? ('0' + m) : m;
        var d = date.getDate();
        d = d < 10 ? ('0' + d) : d;
        var h = date.getHours();
        h = h < 10 ? ('0' + h) : h;
        var minute = date.getMinutes();
        minute = minute < 10 ? ('0' + minute) : minute;
        var second = date.getSeconds();
        second = second < 10 ? ('0' + second) : second;
        return y + '-' + m + '-' + d + ' ' + h + ':' + minute + ':' + second;
    };

    function InitData() {
        var myDate = new Date();
        var nowTime = formatDatetime(myDate);
        data = JSON.parse(data);//返回的数据非标准json，转化一下
        $.each(
            data.data.data,
            function (i, item) {
                var itemDate = new Date(item[0].AlbumDate);
                var endDate = formatDatetime(itemDate)
                list[i] = item[0].Id
                ShoppingItem += "<li class='list-group-item d-flex justify-content-between lh-condensed'>";
                ShoppingItem += "<div> ";
                ShoppingItem += " <img style='width: 50px; height: 50px' src='" + item[0].AlbumUrl + "' alt='" + item[0].AlbumName + "' />";
                ShoppingItem += "<h6 class='my-0'>" + item[0].AlbumName + "</h6>";
                ShoppingItem += "<small class='text-muted'>" + item[0].AlbumDescription + "</small>";
                ShoppingItem += "</div>";
                ShoppingItem += "<span class='text-muted'>￥" + item[0].Price + "</span>";
                ShoppingItem += "</br>";
                if ((Date.parse(nowTime) - Date.parse(endDate)) / (1000 * 60 * 60 * 24) > 30) {
                    ShoppingItem += "<span>折后价：</span><span class='text-muted'>￥" + item[0].Price * 0.8 + "</span>";
                }
                else {
                    ShoppingItem += "<span>折后价：</span><span class='text-muted'>￥" + item[0].Price + "</span>";
                }
                ShoppingItem += "</br>";
                ShoppingItem += "<span>总价</span>";
                if ((Date.parse(nowTime) - Date.parse(endDate)) / (1000 * 60 * 60 * 24) > 30) {
                    ShoppingItem += "<strong>￥" + item[0].SubTotalPrice * 0.8 + "</strong>";
                }
                else {
                    ShoppingItem += "<strong>￥" + item[0].SubTotalPrice + "</strong>";
                }
                ShoppingItem += "</li>";
                $("#userName").val(item[0].UserName);
                $("#userEmail").val(item[0].UserEmail);
            });
        ccc.prepend(ShoppingItem);
    }

    function AddOrder() {
        $.each(
            list,
            function (i, item) {
                $.ajax({
                    type: 'Post',
                    async: false,
                    url: "AddOrders?id=" + item,
                    datatype: 'json',
                    success: function () {
                        $.ajax({
                            type: 'Get',
                            async: true,
                            url: "/ShoppingCart/DeleteSingleShoppingCartItems?id=" + item,
                            datatype: 'json',
                            success: function () {
                            }
                        })
                    }
                });
            });
        alert("提交成功");
        window.location.href = "/Home";
    }
</script>